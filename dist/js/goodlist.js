"use strict";document.addEventListener("DOMContentLoaded",function(){var t=document.querySelector("#mainTworc"),s=document.querySelector("#page"),i=document.querySelector("#prevpage"),o=document.querySelector("#nextpage"),r=0;function c(a){var e=a.datalist.map(function(a){var e=a.bigimg.split("-")[0];return'<div class="mainTwors" data-id="'+a.gid+'">\n                                <img class="mainTworsimg" src="'+e+'" alt="" />\n                                <p>\n                                    <span>满99立减20/</span>\n                                    <span>'+a.goodname+"</span>\n                                </p>\n                                <p>\n                                    <span>￥"+a.price+"</span>\n                                    <span><del>￥"+a.delprice+'</del></span>\n                                    <span>满额立减</span>\n                                </p>\n                                <div class="mainNum">\n                                    <span>\n                                        <input type="text" value="1" class="listNums" />\n                                        <a href="javascript:;" class="addlistNums">+</a>\n                                        <a href="javascript:;" class="cutlistNums">-</a>\n                                    </span>\n                                    <span class="addlistCart">加入购物车</span>\n                                    <span>收藏</span>\n                                </div>   \n                            </div>'}).join("");t.innerHTML=e}var p=new XMLHttpRequest,n="../api/01goodlist.php?page=1&qty=24&time=new Date()";p.open("GET",n,!0),p.send(),p.onreadystatechange=function(){if(4==p.readyState&&200==p.status){var a=p.responseText,e=JSON.parse(a);c(e);var t=Math.ceil(e.total/e.qty);r=t;for(var n=0;n<t;n++)s.innerHTML+='<a href="javascript:;">'+(n+1)+"</a>";2<=t&&(i.style.display="block",o.style.display="block")}};var l=1;s.onclick=function(a){if("a"==(a=a||window.event).target.tagName.toLowerCase()){var e="../api/01goodlist.php?page="+(l=a.target.innerText)+"&qty=24&time=new Date()";p.open("GET",e,!0),p.send(),p.onreadystatechange=function(){if(4==p.readyState&&200==p.status){var a=p.responseText;c(JSON.parse(a))}}}},i.onclick=function(){--l<=1&&(l=1);var a="../api/01goodlist.php?page="+l+"&qty=24&time=new Date()";p.open("GET",a,!0),p.send(),p.onreadystatechange=function(){if(4==p.readyState&&200==p.status){var a=p.responseText;c(JSON.parse(a))}}},o.onclick=function(){r<=++l&&(l=r);var a="../api/01goodlist.php?page="+l+"&qty=24&time=new Date()";p.open("GET",a,!0),p.send(),p.onreadystatechange=function(){if(4==p.readyState&&200==p.status){var a=p.responseText;c(JSON.parse(a))}}},$("#mainTworc").on("click",".addlistNums",function(){var a=$(this).prev().val();100<=++a&&(a=100),$(this).prev().val(a)}),$("#mainTworc").on("click",".cutlistNums",function(){var a=$(this).prev().prev().val();--a<=1&&(a=1),$(this).prev().prev().val(a)}),$("#mainTworc").on("mouseover",".addlistCart",function(){$("#mainTworc .addlistCart").css("background","#F6F6F6"),$("#mainTworc .addlistCart").css("color","#666666"),$(this).css("background","#E5004A"),$(this).css("color","#FFFFFF")}),$("#mainTworc").on("click",".addlistCart",function(){var a=$(this).parent().parent().attr("data-id"),e=$(".listNums").val(),t=Cookie.get("username");n="../api/insertGood.php",data3="gid="+a+" &nums="+e+" &uid="+t+" &time=new Date()",ajax("GET",n,data3,function(a){console.log(a)})});var a=Cookie.get("username");$(".listName").html(a),$(".listBack").click(function(){location.href="reglog.html"}),$(".navTwor").click(function(){Cookie.set("username",Cookie.get("username"),{path:"/"}),location.href="cart.html"}),$(".mainTworc").on("click","img",function(){var a=$(this).parent().attr("data-id");Cookie.set("username",Cookie.get("username"),{path:"/"}),location.href="details.html?id="+a}),document.querySelector(".toTop").onclick=function(){var e=window.setInterval(function(){console.log(window.pageYOffset+":"+e);var a=window.pageYOffset;0<a?window.scrollTo(0,a-20):window.clearInterval(e)},20)}});